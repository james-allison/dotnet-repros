# Android NativeAOT crashes with SKiaSharp.Views.Maui.Controls

Tested on: 
Windows 11 Pro - 25H2 - 26200.7840
Dotnet SDK 10.0.103 with maui-android workload 10.0.103

NativeAot-Android-SkiaSharp.csproj is the default sample dotnet maui app, with a SKCanvasView included on MainPage.xaml, and .UseSkiaSharp() called to during MauiProgram.CreateMauiApp().

<controls1:SKCanvasView Grid.Row="0" ZIndex="0" BackgroundColor="Lime" HorizontalOptions="Fill" VerticalOptions="Fill"/>


The release config has been updated to build with NativeAOT on android.

```
    <Optimize>True</Optimize>
    <OptimizationPreference>Speed</OptimizationPreference>
    <DebugSymbols>False</DebugSymbols>
    <PublishTrimmed>True</PublishTrimmed>
    <PublishAot>True</PublishAot>
    <AndroidPackageFormat>aab</AndroidPackageFormat>
    <AndroidUseAapt2>True</AndroidUseAapt2>
    <AndroidCreatePackagePerAbi>True</AndroidCreatePackagePerAbi>
    <RuntimeIdentifiers>android-arm64</RuntimeIdentifiers>
    <UseMonoRuntime>False</UseMonoRuntime>
    <JsonSerializerIsReflectionEnabledByDefault>False</JsonSerializerIsReflectionEnabledByDefault>

<!-- Workaround for build error IL1011: Failed to write 'obj\Release\net10.0-android36.0\android-arm64\linked\Java.Interop.dll'. -->
    <_UseNativeLibPrefix Condition=" '$(_UseNativeLibPrefix)' == '' ">true</_UseNativeLibPrefix>
```


dotnet publish .\NativeAot-Android-SkiaSharp.csproj --framework net10.0-android36.0 --configuration Release -r android-arm64

doesn't fail - but does an extra ILC warning:

1>  ILC: Method '[SkiaSharp.Views.Android]SkiaSharp.Views.Android.SKCanvasView.Initialize(IAttributeSet)' will always throw because: Failed to load assembly '_Microsoft.Android.Resource.Designer'

When the app is run, it crashes immediately with the following exception:

```
System.Exception: CurrentDomainOnUnhandledException
 ---\u003E System.IO.FileNotFoundException: IO_FileNotFound_FileName, _Microsoft.Android.Resource.Designer
IO_FileName_Name, _Microsoft.Android.Resource.Designer
   at Internal.Runtime.TypeLoaderExceptionHelper.CreateFileNotFoundException(ExceptionStringID, String) \u002B 0x50
   at SkiaSharp.Views.Android.SKCanvasView.Initialize(IAttributeSet) \u002B 0x18
   at SkiaSharp.Views.Maui.Handlers.SKCanvasViewHandler.CreatePlatformView() \u002B 0x38
   at Microsoft.Maui.Handlers.ViewHandler\u00602.OnCreatePlatformView() \u002B 0x58
   at Microsoft.Maui.Handlers.ElementHandler.SetVirtualView(IElement) \u002B 0x58
   at Microsoft.Maui.Controls.Element.SetHandler(IElementHandler) \u002B 0x124
   at Microsoft.Maui.Platform.ElementExtensions.ToHandler(IElement, IMauiContext) \u002B 0x160
   at Microsoft.Maui.Platform.ElementExtensions.ToPlatform(IElement, IMauiContext) \u002B 0x2c
   at Microsoft.Maui.Handlers.LayoutHandler.SetVirtualView(IView) \u002B 0xc8
   at Microsoft.Maui.Controls.Element.SetHandler(IElementHandler) \u002B 0x124
   at Microsoft.Maui.Platform.ElementExtensions.ToHandler(IElement, IMauiContext) \u002B 0x160
   at Microsoft.Maui.Platform.ElementExtensions.ToPlatform(IElement, IMauiContext) \u002B 0x2c
   at Microsoft.Maui.Handlers.LayoutHandler.SetVirtualView(IView) \u002B 0xc8
   at Microsoft.Maui.Controls.Element.SetHandler(IElementHandler) \u002B 0x124
   at Microsoft.Maui.Platform.ElementExtensions.ToHandler(IElement, IMauiContext) \u002B 0x160
   at Microsoft.Maui.Platform.ElementExtensions.ToPlatform(IElement, IMauiContext) \u002B 0x2c
   at Microsoft.Maui.Handlers.ContentViewHandler.UpdateContent(IContentViewHandler) \u002B 0xb4
   at Microsoft.Maui.PropertyMapper.UpdateProperties(IElementHandler, IElement) \u002B 0x8c
   at Microsoft.Maui.Handlers.ElementHandler.SetVirtualView(IElement) \u002B 0x174
   at Microsoft.Maui.Handlers.ContentViewHandler.SetVirtualView(IView) \u002B 0x18
   at Microsoft.Maui.Controls.Element.SetHandler(IElementHandler) \u002B 0x124
   at Microsoft.Maui.Platform.ElementExtensions.ToHandler(IElement, IMauiContext) \u002B 0x160
   at Microsoft.Maui.Platform.ElementExtensions.ToPlatform(IElement, IMauiContext) \u002B 0x2c
   at Microsoft.Maui.Platform.NavigationViewFragment.OnCreateView(LayoutInflater, ViewGroup, Bundle) \u002B 0x9c
   at AndroidX.Fragment.App.Fragment.n_OnCreateView_Landroid_view_LayoutInflater_Landroid_view_ViewGroup_Landroid_os_Bundle_(IntPtr jnienv, IntPtr native__this, IntPtr native_inflater, IntPtr native_container, IntPtr native_savedInstanceState) \u002B 0x260
```

It looks like the _Microsoft.Android.Resource.Designer.dll generated by the SkiaSharp.Views package isn't being linked in.